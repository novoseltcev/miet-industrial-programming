from abc import abstractmethod, ABC

import numpy as np


class PointStorage:
    places = (
        ('msk', 'AP'),
        ('msk', 'TS'),
        ('msk', 'WH'),
        ('mzh', 'TS'),
        ('mzh', 'WH'),
        ('zvn', 'WH'),
        ('NN', 'AP'),
        ('NN', 'TS'),
        ('NN', 'WH'),
        ('dzr', 'TS'),
        ('dzr', 'WH'),
        ('vlg', 'AP'),
        ('vlg', 'TS'),
        ('vlg', 'WH'),
        ('kam', 'TS'),
        ('kam', 'WH'),
    )

    towns = (
        ('Moscow', 'msk'),
        ('Mozhaisk', 'mzh'),
        ('Zvenigorod', 'zvn'),
        ('Nizhniy Novgorod', 'NN'),
        ('Dzerzhinsk', 'dzr'),
        ('Volgograd', 'vlg'),
        ('Kamishin', 'kam'),
    )


class GraphStorage(ABC):
    _data: np.matrix
    INF = np.inf

    @abstractmethod
    def get(self) -> np.matrix:
        ...


class DistanceStorage(GraphStorage):
    def __init__(self):
        self._data = np.matrix([
            [0, 20, 30, 108, 110, 65, 398, 0, 0, 0, 0, 926, 0, 0, 0, 0],
            [20, 0, 10, 98, 100, 55, 0, 415, 0, 483, 0, 0, 937, 0, 1204, 0],
            [30, 0, 0, 108, 110, 65, 0, 0, 430, 0, 390, 0, 0, 652, 0, 1234],

            [108, 98, 108, 0, 5, 0, 0, 0, 0, 581, 0, 0, 1035, 0, 1302, 0],
            [110, 100, 110, 5, 0, 78, 0, 0, 540, 0, 500, 0, 0, 1062, 0, 1344],

            [65, 55, 65, 0, 78, 0, 0, 0, 495, 0, 455, 0, 0, 1017, 0, 1299],

            [398, 0, 0, 0, 0, 0, 0, 19, 23, 0, 26, 828, 0, 0, 0, 0],
            [0, 415, 0, 0, 0, 0, 19, 0, 4, 32, 0, 0, 840, 0, 919, 0],
            [0, 0, 430, 0, 540, 495, 23, 4, 0, 0, 40, 0, 0, 849, 0, 1010],

            [0, 483, 0, 581, 0, 0, 0, 32, 0, 0, 4, 0, 872, 0, 951, 0],
            [0, 0, 390, 0, 500, 455, 26, 0, 40, 4, 0, 0, 0, 889, 0, 1050],

            [926, 0, 0, 0, 0, 0, 828, 0, 0, 0, 0, 0, 15, 16, 0, 285],
            [0, 937, 0, 1035, 0, 0, 0, 840, 0, 872, 0, 15, 0, 2, 257, 281],
            [0, 0, 952, 0, 1062, 1017, 0, 0, 849, 0, 889, 16, 2, 0, 0, 282],

            [0, 1204, 0, 1302, 0, 0, 0, 919, 0, 951, 0, 0, 257, 0, 0, 2],
            [0, 0, 1234, 0, 1344, 1299, 0, 0, 1010, 0, 1050, 285, 281, 282, 2, 0],
        ])

    def get(self) -> np.matrix:
        return self._data


